http://wangdoc.com/javascript/stdlib/regexp.html

## 正则表达式 是什么？
是一种表达文本模式（即字符串结构）的方法，常常用来按照给定模式匹配文本。比如正则表达式给出一个 email 地址的模式，用来确定一个字符串是否为 email 地址。

比如你写一个正则表达式，匹配出所有美女。

## 新建正则表达式的方法

- 字面量形式
```
var regex = /xyz/
```

- RegExp 构造函数
```
var regex = new RegExp('xyz')
```

- 两种方法的区别：字面量形式，在引擎编译时就会新建正则；构造函数的形式在运行时新建正则。所以，前者的效率较高，一般使用前者的形式。

## 实例属性

**修饰符相关的属性，皆只读**
- ignoreCase 返回布尔值，表示是否设置了 i 修饰符。
- global ...g 修饰符。
- multiline ...m 修饰符
- flags 返回字符串，包含了已经设置的所有修饰符，按字母排序。

```
var r = /abc/igm
r.ignoreCase  // true
r.global  // true
r.multiline //true
r.flags // 'gim'
```

**其他实例属性**
- lastIndex 返回一个整数，表示下一次开始搜索的位置。该属性可读写，但是只在进行连续搜索时有意义。
- source：返回正则表达式的字符串形式（不包括反斜杠），该属性只读。
```
var r = /abc/igm

r.lastindex // 0
r.source  // "abc"
```

## 实例方法

### test() 方法
正则实例对象的test方法返回一个布尔值，表示当前模式是否能匹配参数字符串。

```
/cat/.test('cats and dogs')   // true
```

如果正则表达式带有g修饰符，则每一次test方法都从上一次结束的位置开始向后匹配。

```
var r = /x/g

var s = '_x_x'

r.test(s) // true
```
r 带有 g 修饰符，可以一直往下匹配。此时可以试试 lastIndex 属性，看一下下一次匹配的位置。也就是说，正则内部会记住上一次 lastIndex 的值，所以，不要临时更换所要匹配的字符串。(lastIndex 只对同一个正则表达式有效)。

注意，当匹配多次匹配到字符串末尾，lastIndex 属性就自动设为 0 了。

**如果正则模式是一个空字符串，则匹配所有字符串**
```
new RegExp('').test('abc')  // true
```

### exec() 方法
把匹配成功的结果组成数组返回，不匹配则返回 null.

```
// 例1
var r = /x/
var s = '_x_x'

r.exec(s)   // ["x", index: 1, input: "_x_x", groups: undefined]

// 例2
var s = '_x_x'
var r = /_(x)/

r.exec(s)   // // ["_x", "x"]
```

正则实例对象的lastIndex属性不仅可读，还可写。设置了g修饰符的时候，只要手动设置了lastIndex的值，就会从指定位置开始匹配。

看代码
```
var reg  =/a/g;

var str= 'abc_abc_abc';

while(true){
    var match = reg.exec(str)
    if(!match) break
    console.log('#'+match.index+' : '+match[0])
}

#0 : a
#4 : a
#8 : a
```

## 字符串的实例方法
- String.prototype.match()：返回一个数组，成员是所有匹配的子字符串。
- String.prototype.search()：按照给定的正则表达式进行搜索，返回一个整数，表示匹配开始的位置。
- String.prototype.replace()：按照给定的正则表达式进行替换，返回替换后的字符串。
- String.prototype.split()：按照给定规则进行字符串分割，返回一个数组，包含分割后的各个成员。

```
var r = /x/;

var s = 'xx_xx_xx';

s.match(r)

s.search('x')

s.replace(/x/g, 'h')
```

**以下，s 是字符串，r 是正则**
- match s.match(r) 匹配成功，返回一个数组，匹配失败返回 null，跟 exec() 方法很像。

注意：如果正则带有 g 修饰符，与exec()不同的是，match 方法会返回所有匹配的结果
```
var s = 'abba'
var r = /a/g

s.match(r)  // [a,a]
```

注意：设置正则 lastIndex 属性对 match 方法无效。match 方法总是从第一个字符开始匹配。

- 字符串对象的search方法，返回第一个满足条件的匹配结果在整个字符串中的位置。如果没有任何匹配，则返回-1。
```
var s = 'abba'
var r = /a/

s.search(r) // 0
```

- 字符串对象的replace方法可以替换匹配的值。它接受两个参数，第一个是正则表达式，表示搜索模式，第二个是替换的内容。正则表达式如果不加g修饰符，就替换第一个匹配成功的值，否则替换所有匹配成功的值。
```
var s = 'abba'
var r = /a/

s.replace(r, 'k')
```

- 去掉字符串收尾两端的空格
```
var s = '   adfj   ';
var r = /^\s+|\s+$/g;

s.replace(r,'')
```
**$ 符号相关**
$&：匹配的子字符串。
$`：匹配结果前面的文本。
$'：匹配结果后面的文本。
$n：匹配成功的第n组内容，n是从1开始的自然数。
$$：指代美元符号$。
```
var s = 'janson'

s.replace('a', '-$\'-$&-$`-')
// "j-nson-a-j-nson"
```

- replace方法的第二个参数还可以是一个函数，将每一个匹配内容替换为函数返回值。